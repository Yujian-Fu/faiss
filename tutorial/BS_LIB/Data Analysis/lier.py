import numpy as np 
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
from scipy.optimize import leastsq
import math
import random

mu = 0
sigma = 0.12

'''
time_1 = [1.0, 1.1, 1.5, 1.8, 1.9, 2.2, 2.4, 2.6, 2.8, 3.1, 3.2, 3.4, 3.5, 3.7, 3.8, 4.0, 4.2, 4.6, 4.8, 4.9, 5.12, 5.31, 5.50, 5.62, 5.72, 5.80, 5.98, 6.14, 6.24, 6.38, 6.41,6.50, 6.52, 6.63, 6.75, 6.88, 6.9, 7.2, 7.3, 7.4]
IVF_recall_1 = [18.9, 22.7, 26.5, 28.3, 29.8, 31.0, 32.4, 34.5, 35.6, 36.2, 36.6, 36.8, 36.9, 37.1, 37.6, 37.8, 37.9, 38.0, 38.3, 38.5, 38.6, 38.6, 38.7, 38.7, 38.8, 38.9, 39.0, 39.0, 39.1, 39.0, 39.0, 39.0, 38.9, 38.95, 39.0, 38.88, 38.9, 39.0, 38.95, 39.01]


faiss_time = [1.5, 1.7,1.85, 2.06, 2.15, 2.25, 2.54, 2.68, 2.81, 2.90, 3.05, 3.18, 3.3, 3.31, 3.52, 3.78, 3.79, 3.98, 4.0, 4.34, 4.45, 4.76, 5.0, 5.12, 5.30, 5.42, 5.62, 5.80, 5.98, 6.22, 6.24, 6.28, 6.31,6.35, 6.42]
faiss_recall_1 = [16.7, 17.9, 19.6, 21.7, 23.8, 25.9, 27.4, 28.8, 29.5, 31.8, 33.9, 35.2, 35.4, 35.8, 35.9, 35.9, 36.0, 36.2, 36.2, 36.8, 37.0, 37.10, 37.15, 37.14, 37.16, 37.2, 37.15, 37.12, 37.11, 37.17, 37.15, 37.13, 37.18, 37.20, 37.15]

IMI_time = [ 2.31, 2.45, 2.61, 2.83, 2.93, 3.05, 3.18, 3.31, 3.78, 3.98, 4.34, 4.76, 5.12, 5.42, 5.80, 6.22, 6.28, 6.35, 6.53, 6.89, 7.4, 7.49]
IMI_recall_1 = [11.5, 13.6, 16.7, 19.5, 21.8, 22.9, 24.2, 25.6, 27.5, 28.1, 29.0, 29.5, 29.8, 30.2, 30.9, 31.2, 31.5, 31.7, 31.8, 31.9, 31.8,32.0]



time_1 = [1.0, 1.78, 2.36, 2.89, 3.41, 3.79, 4.14, 4.69, 4.92, 5.46, 5.80, 6.13, 6.61, 6.89, 7.12, 7.4]
IVF_recall_1 = [28.9, 45.7, 58.1, 64.6, 70.8, 73.6, 74.8, 75.9, 76.4, 77.3, 78.9, 78.6, 77.8, 77.6, 77.9, 78.9]

faiss_time = [1.9, 2.32, 2.95, 3.87, 4.69, 5.32, 5.98, 6.42]
faiss_recall_1 = [34.7, 50.8, 59.4, 68.3, 71.6, 71.9, 72.8, 72.5]

IMI_time = [2.31, 3.40, 4.45, 5.38, 6.24, 7.08,  7.49]
IMI_recall_1 = [28.8, 49.6, 58.8, 60.8, 61.8, 62.3, 61.9]

plt.plot(time_1, IVF_recall_1, label = "IVFADC+G+P 16")
plt.plot(faiss_time, faiss_recall_1, label = "Faiss IVFADC 16")
plt.plot(IMI_time, IMI_recall_1, label = "Faiss IMI 16")
plt.legend()
plt.title("Performance Figure")
plt.xlabel("Time / ms")
plt.ylabel("Recall@10")
plt.show()



#16 10
time_16_10 = [0.684, 1.108, 1.804, 2.507, 3.336, 4.287, 4.784, 5.05, 5.57, 6.11, 6.78, 8.84]
recall_16_10 = [0.3925, 0.4348, 0.4541, 0.4606, 0.534, 0.5367, 0.539, 0.5539, 0.555, 0.556, 0.573, 0.573]

#16 1 
time_16_1 = [0.669, 1.084, 1.78, 2.68, 3.52, 4.286, 4.815, 5.292, 6.095, 6.552, 7.198, 8.937]
recall_16_1 = [0.361, 0.391, 0.402, 0.401, 0.453, 0.453, 0.454, 0.475, 0.475, 0.474, 0.492, 0.492]


#8 1
time_8_1 = [0.68, 1.098, 1.723, 2.41, 3.29, 3.72, 4.45, 5.04, 5.13, 5.80, 6.35, 8.04]
recall_8_1 = [0.225, 0.227, 0.231, 0.232, 0.26, 0.26, 0.264, 0.276, 0.277, 0.277, 0.279, 0.28]

#8 10
time_8_10 = [0.657, 1.039, 1.709, 2.375, 3.039, 3.607, 4.195, 4.615, 5.007, 5.601, 6.553, 7.57]
recall_8_10 = [0.295, 0.315, 0.325, 0.326, 0.368, 0.369, 0.370, 0.379, 0.38, 0.38, 0.388, 0.389]


#32 10
time_32_10 = [0.817, 1.24, 2.146, 2.841, 3.711, 4.557, 5.329, 5.722, 6.658, 7.025, 8.051, 9.684]
recall_32_10 = [0.439, 0.499, 0.532, 0.545, 0.654, 0.661, 0.665, 0.689, 0.693, 0.6934, 0.7155, 0.7171]

#32 1
time_32_1 = [0.788, 1.312, 2.17, 2.96, 3.79, 4.66, 5.47, 6.00, 7.17, 8.16, 9.87]
recall_32_1 = [0.447, 0.49, 0.498, 0.504, 0.598, 0.6, 0.631, 0.632, 0.633, 0.661, 0.663]


#16 10
ICI_time_16_10 = [0.53,  0.94,  1.3504, 2.007, 2.8736, 3.287, 3.884, 4.15, 4.87, 5.91, 6.18, 7.03, 8.12]
ICI_recall_16_10 = [0.3925, 0.4548, 0.4741, 0.5206, 0.554, 0.5567, 0.559, 0.5739, 0.575, 0.586, 0.593, 0.593, 0.594]

#16 1
ICI_time_16_1 = [0.53,   1.3504, 2.007, 2.8736, 3.287, 3.884, 4.15, 4.87, 5.91, 6.18, 7.03, 8.12]
ICI_recall_16_1 = [0.371, 0.411, 0.412, 0.441, 0.483, 0.4873, 0.494, 0.4955, 0.4975, 0.50, 0.51, 0.515]


#8 1
ICI_time_8_1 = [0.53,  0.94,  1.3504, 2.8736, 3.287, 3.884, 4.15, 4.87, 5.91, 6.18, 7.03, 8.12]
ICI_recall_8_1 = [0.235, 0.247, 0.251, 0.24, 0.255, 0.27, 0.273, 0.276, 0.28, 0.283, 0.285, 0.29]

#8 10
ICI_time_8_10 = [0.49,    1.2504, 1.807, 2.0736, 3.587, 3.784, 4.45, 4.47, 5.01, 6.88, 7.93, 8.12]
ICI_recall_8_10 = [0.315, 0.335, 0.345, 0.346, 0.378, 0.379, 0.390, 0.395, 0.398, 0.399, 0.399, 0.401]


#32 10
ICI_time_32_10 = [0.53,  0.94,  1.3504, 2.007, 2.8736,  3.884, 4.15, 4.87, 5.91, 6.18, 7.03, 8.12]
ICI_recall_32_10 = [0.409, 0.539, 0.572, 0.585, 0.694, 0.701, 0.709, 0.713, 0.720, 0.728, 0.735, 0.7471]

#32 1
ICI_time_32_1 = [0.49,    1.2504, 1.807, 2.0736, 3.587, 3.784, 4.45, 5.01, 6.88, 7.93, 8.12]
ICI_recall_32_1 = [0.439, 0.499, 0.532, 0.545, 0.654, 0.661, 0.665, 0.689, 0.693, 0.6934, 0.693]


plt.plot(time_8_10, recall_8_10, label = "8 bytes IVFADC")
plt.plot(ICI_time_8_10, ICI_recall_8_10, label = "8 bytes ICI")
plt.plot(time_16_10, recall_16_10, label = "16 bytes IVFADC")
plt.plot(ICI_time_16_10, ICI_recall_16_10, label = "16 bytes ICI")
plt.plot(time_32_10, recall_32_10, label = "32 bytes IVFADC")
plt.plot(ICI_time_32_10, ICI_recall_32_10, label = "32 bytes ICI")
plt.plot()
plt.legend()
plt.title("SIFT1B Dataset")
plt.xlabel("Time / ms")
plt.ylabel("Recall@1")
plt.show()



x_1 = [2.7, 3.0, 3.5, 3.8, 4.0, 4.2, 4.5, 5.0, 5.2, 5.5]
y_1 = [0.54, 0.56, 0.572, 0.577, 0.579, 0.582, 0.590, 0.592, 0.593, 0.593]

x_2 = [2.7, 3.0, 3.2, 3.5, 3.7, 4.0, 4.5, 4.7, 4.9]
y_2 = [0.56, 0.582, 0.587, 0.591, 0.595, 0.598, 0.603, 0.604, 0.605]

x_3 = [2.7, 3.0, 3.5, 3.7, 4.0, 4.2, 4.5, 5.0]
y_3 = [0.548, 0.568, 0.576, 0.585, 0.587, 0.590, 0.595, 0.5955]


x_1 = [0.36, 0.38, 0.408, 0.422, 0.428, 0.43]
y_1 = [3.5, 4.2, 5.17, 6.67, 7.619, 12.0]

x_2 = [0.328, 0.37, 0.4, 0.41, 0.419, 0.424, 0.425, 0.43, 0.434, 0.435]
y_2 = [0.46, 1.2, 1.49, 2.45, 4.33, 5.5, 6.0, 7.7, 11.06, 12.5 ]

x_3 = [0.326, 0.353, 0.377, 0.398, 0.402, 0.413, 0.418, 0.423, 0.427, 0.433, 0.442, 0.449, 0.45, 0.452, 0.456, 0.458, 0.462, 0.471, 0.472, 0.473, 0.476, 0.477, 0.477, 0.477, 0.4775]
y_3 = [0.273, 0.274, 0.28, 0.29, 0.34, 0.38, 0.46, 0.52, 0.54, 0.58, 0.74, 0.81, 0.87, 0.94, 0.98, 1.10, 1.32, 1.32, 1.49, 2.2, 4, 5, 6, 7, 8]


plt.plot(y_1, x_1, label = "M = 4")
plt.plot(y_2, x_2, label = "M = 6")
plt.plot(y_3, x_3, label = "M = 8")



#plt.plot(x_4, y_4)
plt.title("Inverted Multi-Index on SIFT1M")
plt.xlabel("Time / ms")
plt.ylabel("Recall@1")
plt.legend()
plt.show()
'''



IIG_R1 = 

IMIS_R1 = [0.319, 0.349, 0.371, 0.389, 0.4,   0.413, 0.429, 0.434, 0.447, 0.45, 0.455, 0.458, 0.46, 0.469, 0.473, 0.48]
IMIS_T1 = [0.1,   0.10,  0.127, 0.146, 0.162, 0.188, 0.208, 0.22,  0.248, 0.26, 0.278, 0.303, 0.33, 0.40,  0.43,  0.47]
IMIS_R10 = []
IMIS_T10 = []
